<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Search Bug</title>
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<style>
* {
	box-sizing: border-box;
}

h1 {
	text-align: center;
	margin-top: -40px;
	margin-bottom: 15px;
}

h2 {
	text-align: center;
}

form {
	width: 40%;
	margin: 30px auto;
}

#bugName {
	font-size: 20px;
}

.bugLabel {
	font-size: 20px;
}

table {
	margin-top: 50px;
}

span {
	color: red;
	margin-left: 3px;
}

.searchForm {
	width: 50%;
	margin: 0px auto;
}

.searchButton {
	margin-left:5px;
	height: 40%;
	margin-top: 30px;
	font-size: 20px;
}

footer {
    position:relative;
	bottom: 0;
	left:50%;
	transform:translateX(-50%);
	height: 100px;
}
</style>
</head>

<body class="jumbotron">
	<h1>BUG TRACKING SYSTEM</h1>
	<nav class="navbar navbar-expand-md bg-dark navbar-dark">
		<button class="navbar-toggler" type="button" data-toggle="collapse"
			data-target="#collapsibleNavbar">
			<span class="navbar-toggler-icon"></span>
		</button>
		<div class="collapse navbar-collapse" id="collapsibleNavbar">
			<ul class="navbar-nav">
				<li class="nav-item"><a class="nav-link" href="index.html">Home</a>
				</li>
				<li class="nav-item"><a class="nav-link" href="aboutUs.html">About
						Us</a></li>
			</ul>
		</div>
	</nav>
	<div>
		<h2>Search Bug</h2>
	</div>
	<div class="form-group row searchForm">
		<form id="bugSearchForm" class="col-sm-9 row">
			<label for="bugName" class="col-sm-4 bugLabel">Bug Name<span>*</span></label>
			<input type="text" class="form-control col-sm-8" id='bugName' required>
		</form>
		<button type="button" id="searchBug"
			class="btn btn-primary col-sm-3 searchButton" onclick="getBug()">Search</button>
	</div>
	<table class="table table-striped">
		<thead>
			<th>Id</th>
			<th>Name</th>
			<th>Priority</th>
			<th>Type</th>
			<th>Build Version</th>
			<th>Synopsis</th>
			<th>Status</th>
		</thead>
		<tbody id="resultTable">
		</tbody>
	</table>
	<!-- Footer -->
	<div>
	<footer class="page-footer font-small blue">
  
     <div class="col-lg-12 col-md-12 text-center">
		<div class="footer-copyright text-center py-3">
			Â© 2021 Copyright: <a href="http://localhost:8082/index.html">Bug Tracking
				System </a>
		</div>
		</div>
     
	</footer>
	</div>

</body>
<script>
	function getBug() {
		if (!bugSearchForm.checkValidity()) {
			alert('Bug name is invalid');
			return;
		}
		let bugName = document.getElementById('bugName').value;
		bugName = bugName.trim();
		if (bugName) {
			const promise = fetch('/bug');
			promise.then(function(response) {
				return response.json();
			}).then(function(bugs) {
					const table = document.getElementById('resultTable');
					table.innerHTML='';
					let found=false;
					for(let i=0;i<bugs.length;i++){
						const bug = bugs[i];
						const currentBugName = bug.name;
						if(currentBugName==bugName){
							const row = document.createElement('tr');
							const idColumn = document.createElement('td');
							const nameColumn = document.createElement('td');
							const priorityColumn = document.createElement('td');
							const typeColumn = document.createElement('td');
							const buildVersionColumn = document.createElement('td');
							const synopsisColumn = document.createElement('td');
							const statusColumn = document.createElement('td');
							idColumn.append(bug.id);
							nameColumn.append(bug.name);
							priorityColumn.append(bug.priority);
							typeColumn.append(bug.type);
							buildVersionColumn.append(bug.buildVersion);
							synopsisColumn.append(bug.synopsis);
							statusColumn.append(bug.status);
							row.appendChild(idColumn);
							row.appendChild(nameColumn);
							row.appendChild(priorityColumn);
							row.appendChild(typeColumn);
							row.appendChild(buildVersionColumn);
							row.appendChild(synopsisColumn);
							row.appendChild(statusColumn);
							table.appendChild(row);
							found=true;
						}
					}
					if(!found){
						alert("Invalid Bug Name");
					}
			});
		} else {
			alert("Invalid Bug Name");
		}

	}
</script>

</html>